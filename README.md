# Бот поиска Prom.ua

Ниже кратко описано, как подготовить окружение, настроить переменные и запустить бота.

## Требования
- Python 3.11+.
- PostgreSQL (для хранения пользователей и логов запросов).
- Токен Telegram-бота.

## Установка
1. Клонируйте репозиторий и перейдите в папку проекта.
2. Создайте виртуальное окружение и активируйте его:
   ```bash
   python -m venv .venv
   source .venv/bin/activate
   ```
3. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

## Настройка окружения
Создайте файл `.env` в корне и заполните переменные:
```env
BOT_TOKEN=ваш_telegram_bot_token
POSTGRES_DSN=postgresql+asyncpg://user:password@host:5432/dbname

# Необязательные настройки
REQUIRED_CHANNELS=@channel1,@channel2      # через запятую; можно оставить пустым
DAILY_QUERY_LIMIT=10                       # суточный лимит запросов
CACHE_TTL_SECONDS=3600                     # TTL кэша для поиска
PROM_SEARCH_URL=https://prom.ua/search     # базовый URL поиска
DEVELOPER_CONTACT_URL=                     # ссылка/ник разработчика
ORDER_PARSER_URL=                          # ссылка/ник для заказа парсера/безлимита
BOOST_PRODUCTS_URL=                        # ссылка/ник для продвижения товаров
```

## Запуск
Активируйте виртуальное окружение (если не активно) и выполните:
```bash
python -m bot.app
```
Бот поднимется в режиме long polling. Для перезапуска достаточно остановить процесс и запустить команду снова.

## Как пользоваться
- Отправьте боту одно или несколько поисковых выражений через запятую или точку.
- Бот соберёт товары с первой страницы Prom.ua и пришлёт Excel-файл с результатами.
- Лимит по умолчанию: `DAILY_QUERY_LIMIT` запросов в сутки (повторные запросы учитываются).
- Команды:
  - `/start` — приветствие и базовая информация.
  - `/help` — краткая инструкция и лимиты.
  - `/services` — ссылки/ники из `ORDER_PARSER_URL` и `BOOST_PRODUCTS_URL`.
- Если настроены обязательные каналы (`REQUIRED_CHANNELS`), пользователь должен быть на них подписан, иначе бот напомнит о подписке.

## Проверка перед запуском
- Убедитесь, что `.env` заполнен и база PostgreSQL доступна.
- Проверьте, что токен бота активен и бот не заблокирован пользователями, с которыми тестируете.

Готово: после запуска бот отвечает на команды и сообщения в Telegram согласно логике обработчиков в `bot/handlers/`.
